---
title: "Analysis of Crime Offences in European Countries (2022)"
author: "Aakriti Abhay Singh 24215296"
format: pdf
editor: visual
---

## Introduction

This report analyzes the dataset `crim_off_cat_2022.xlsx`, which records various offenses per hundred thousand inhabitants in 41 European countries for the year 2022. The objective of this report is to perform data manipulation and cleanup, and to derive insights regarding crime rates across different countries.

## Task 1: Data Manipulation

### 1. Loading the Dataset

First, we will load the necessary library and import the dataset from the provided Excel file. We will skip the first eight rows to obtain the relevant data.

```{r}
library(readxl)

dataset <- read_excel("crim_off_cat_2022.xlsx", 
                      skip = 8, 
                      n_max = 41)


head(dataset, 5)
```

### 2. Getting the size and structure of this dataset

Next, we will examine the size (number of observations and variables) and the structure of the dataset to understand its composition.

```{r}

dimensions <- dim(dataset)

cat("Number of observations (rows):", dimensions[1], "\n")
cat("Number of variables (columns):", dimensions[2], "\n\n\n")

cat("Structure of dataset: \n\n")
str(dataset)
```

### 3. Renaming the First Column

We will rename the first column to "Country" for clarity

```{r}
colnames(dataset)[1] <- "Country"
colnames(dataset)
```

### 4. Remove the following columns:

-   Child pornography
-   Rape
-   Sexual assault
-   Theft
-   Theft of a motorized vehicle or parts thereof
-   Burglary
-   Burglary of private residential premises

we will install dplyr package

```{r}
library(dplyr)
dataset_clean <- dataset %>%
  select(-`Child pornography`, 
         -Rape, 
         -`Sexual assault`, 
         -Theft, 
         -`Theft of a motorized vehicle or parts thereof`, 
         -Burglary, 
         -`Burglary of private residential premises`)

colnames(dataset_clean)

```

### 5. Identifying Countries with Missing Data

we will identify countries that contain any missing data. We will replace any occurrences of ":" with NA and then count the number of missing values for each country.

```{r}

dataset_clean[dataset_clean == ":"] <- NA

dataset_clean$missing_count <- rowSums(is.na(dataset_clean))

countries_with_missing_data <- dataset_clean %>%
  filter(missing_count > 0) %>%
  select(Country, missing_count)


cat("Countries with missing data and their missing value counts:\n")
print(countries_with_missing_data)

dataset_clean <- dataset_clean %>%
  select(-missing_count)
```

### 6. Removing Countries with Missing Data

```{r}
dataset_final <- dataset_clean %>%
  filter(complete.cases(.))

cat("Dataset after removing countries with missing data:\n")
head(dataset_final , 5)
```

### 7. Adding a Column for Total Offences

We will add a new column to our dataset that contains the overall record of offences for each country, calculated as the sum of the other offence-related columns.

```{r}
offence_columns <- dataset_final[ , -which(names(dataset_final) == "Country")]
offence_columns_numeric <- offence_columns %>%
  mutate_all(~as.numeric(.))

total_offences <- rowSums(offence_columns_numeric, na.rm = TRUE)

dataset_final$Total_Offences <- total_offences

cat("Updated dataset with total offences:\n")
head(dataset_final)

```

### 8. Final Size of the Cleaned Dataset

```{r}
dimensions <- dim(dataset_final)

cat("Number of observations (rows):", dimensions[1], "\n")
cat("Number of variables (columns):", dimensions[2], "\n")

```

### Data Summary

After cleaning the dataset, we have a total of 14 countries with no missing data and 16 variables (including the new total offenses column).

### Key Observations:

-   The country with the highest recorded offenses is **Germany** at **3553.38**, primarily driven by serious assault and fraud rates.

-   **Spain** follows with **2440.44** offenses, while **Slovenia** has the lowest total at **665.64**.

-   Notably, countries like **Italy** and **Finland** exhibit significant rates in various categories, warranting further investigation.

## Task 2: Analysis

### 1. Table of Organized Criminal Group Participation

We will create a table displaying the countries along with their records of participation in an organized criminal group, sorted from highest to lowest values.\

the columns (including **"Participation in an organized criminal group"**) are stored as character strings instead of numeric values. So firstly we need to convert these character strings to numeric values.

#### A.

Convert Character Columns to Numeric

Converting relevant columns to numeric

```{r}

dataset_final <- dataset_final %>%
  mutate(across(c(`Participation in an organized criminal group`, 
                   `Intentional homicide`, 
                   `Attempted intentional homicide`, 
                   `Serious assault`, 
                   `Kidnapping`, 
                   `Sexual violence`, 
                   `Sexual exploitation`, 
                   `Robbery`, 
                   `Unlawful acts involving controlled drugs or precursors`, 
                   `Fraud`, 
                   `Corruption`, 
                   `Bribery`, 
                   `Money laundering`, 
                   `Acts against computer systems`), 
                 as.numeric))


```

#### B.

Once the conversion is done, we can create the table and identify the country with the highest record as follows:

```{r}
library(kableExtra)

organized_crime_participation <- dataset_final %>%
  select(Country, `Participation in an organized criminal group`) %>%
  arrange(desc(`Participation in an organized criminal group`)) %>%
  mutate(`Participation in an organized criminal group` = 
           round(`Participation in an organized criminal group`, 1))

kable(organized_crime_participation, caption = 
        "Organized Criminal Group Participation by Country (2022)") %>%
  kable_styling(full_width = F, position = "left")

```

### 2. Country with the Highest Participation

```{r}

highest_participation_country <- dataset_final %>%
  filter(`Participation in an organized criminal group` == 
           max(`Participation in an organized criminal group`, na.rm = TRUE)) %>%
  pull(Country)

cat("Country with the highest record of participation in 
    an organized criminal group in 2022:", highest_participation_country, "\n")

```

### 3. plot that visualizes the relationship between Robbery and Unlawful acts involving controlled drugs or precursors.

```{r}

library(ggplot2)

ggplot(dataset_final, aes(x = `Robbery`, 
                          y = `Unlawful acts involving controlled drugs or precursors`, 
                          label = Country)) +
  geom_point(color = "blue", size = 2) + 
  geom_text(vjust = -0.5, size = 3.5) + 
  
  labs(title = "Relationship between Robbery and Unlawful Acts ",
       x = "Robbery (per 100,000 inhabitants)",
       y = "Unlawful Acts (per 100,000 inhabitants)") +
  theme_minimal() +  
  theme(plot.title = element_text(hjust = 0.5))  #

```

### Conclusion

This analysis provides a detailed overview of crime offenses in European countries, highlighting critical insights and visualizations that can aid in understanding the dynamics of crime in the region.

## Task 3: Creativity

### PLot1: Heatmap of Serious Assault, Robbery, and Fraud

The heatmap will visualize the relationships between serious assault, robbery, and fraud across countries, allowing us to see how these crime categories correlate with one another.

```{r}

library(ggplot2)
library(reshape2)

crime_data <- dataset_final %>%
  select(Country, `Serious assault`, Robbery, Fraud)


correlation_matrix <- cor(crime_data[, -1], use = "pairwise.complete.obs")

melted_cor <- melt(correlation_matrix)

ggplot(melted_cor, aes(Var1, Var2, fill = value)) +
  geom_tile() +
  scale_fill_gradient2(low = "darkgreen", high = "pink", mid = "white", 
                       midpoint = 0, limit = c(-1, 1), 
                       name = "Correlation") +
  geom_text(aes(label = round(value, 2)), color = "black", size = 4) + 
  labs(title = "Correlation Heatmap with Values: Serious Assault, Robbery, Fraud",
       x = "Crime Categories",
       y = "Crime Categories") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

This Heatmap summarizes the pairwise correlations:

-   The correlation between Serious Assault and Fraud is 0.56, which indicates a moderate positive relationship.
-   Robbery and Fraud have a stronger positive correlation of 0.70.
-   Serious Assault and Robbery have a lower positive correlation of 0.33.

### Interpretation

-   `Serious Assault and Fraud`: Moderate correlation suggests that countries with high levels of serious assault may also experience higher fraud rates.

-   `Robbery and Fraud`: The strong correlation between robbery and fraud implies that these two crime types tend to occur together more frequently.

-   `Serious Assault and Robbery`: The weaker correlation of 0.33 suggests that while they are positively related, the connection between these two crimes is not as strong as with fraud.

### Plot 2: Top 5 Countries for Cybercrime and Drug-Related Offenses

```{r}

library(ggplot2)
library(reshape2)

top_5_cyber_drug <- dataset_final %>%
  arrange(desc(`Acts against computer systems` + 
                 `Unlawful acts involving controlled drugs or precursors`)) %>%
  select(Country, `Acts against computer systems`, 
         `Unlawful acts involving controlled drugs or precursors`) %>%
  slice(1:5)

top_5_long <- melt(top_5_cyber_drug, id.vars = "Country", 
                   variable.name = "Crime_Type", value.name = "Offenses")

ggplot(top_5_long, aes(x = reorder(Country, Offenses), 
                       y = Offenses, 
                       fill = Crime_Type)) +
  geom_bar(stat = "identity", 
           position = position_dodge(width = 0.8), width = 0.7) + 
  geom_text(aes(label = round(Offenses, 1)), 
            position = position_dodge(width = 0.8), 
            vjust = -0.5, size = 2.5) + 
  scale_fill_manual(values = c("dodgerblue", "darkorange")) +
  labs(title = "Top 5 Countries for Cybercrime and Drug-Related Offenses",
       x = "Country", 
       y = "Offenses (per 100,000 inhabitants)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

```

### Insights

The bar plot highlights the top 5 countries with the highest recorded offenses in **cyber crime (Acts against computer systems)** and **drug-related offenses (Unlawful acts involving controlled drugs or precursors)**. These countries are **Lithuania**, **Croatia**, **Germany**, **Finland**, and **Austria** .

1.  **Austria's Cyber crime Surge**: Austria is a major outlier in terms of cybercrime, with **244.7 offenses per 100,000 inhabitants**, significantly higher than the other countries. This suggests that Austria faces a unique challenge in the realm of cybercrime, perhaps due to higher internet penetration or sophisticated criminal networks targeting digital systems.

2.  **Finland's Drug-Related Offenses**: Finland records the highest drug-related offenses at **454.3**. This could indicate higher drug consumption or stricter law enforcement practices targeting drug-related crimes.

3.  **Germany's Balance**: Germany shows a moderate level of both cybercrime and drug-related offenses, indicating that it faces issues in both categories but is not an extreme outlier in either.

4.  **Lithuania's Cyber Focus**: Lithuania has lower drug-related offenses (**109.8**) but still reports a moderate rate of cybercrime (**32.7**). This could suggest a focus on digital crime prevention or that cybercrime is a growing threat in the country compared to drug offenses.

5.  **Dual Crime Threat in Croatia and Finland**: Both **Croatia** and **Finland** report relatively high levels of both cybercrime and drug-related offenses. This suggests that these countries may face dual crime challenges and require comprehensive strategies to address both the digital and narcotics-related criminal activities.
